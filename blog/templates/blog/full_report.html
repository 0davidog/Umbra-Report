{% extends 'base.html' %} {% block content %}
{% load static %}
{% load crispy_forms_tags %}

<div class="container-fluid">
    <div class="card border-secondary mb-3">
        <div class="card-header bg-transparent border-secondary">{{ report.author }}</div>
        <div class="card-body">
        <h2 class="card-title">{{ report.title }}</h2>
        <p class="card-text">{{ report.content | safe }}</p>
        </div>
        <div class="card-footer bg-transparent border-secondary">{{ report.created_on }}</div>
    </div>




  <!-- Displaying count of comments -->
  <div class="row">
    <div class="col-md-8">
        <div class="card border-secondary mb-3 p-3">
            <div class="card-header border-secondary">
                <h3 class="card-title">Comments <i class="far fa-comments"></i></h3> ({{ comment_count }})
            </div>
            <div class="card-body">
                
                {% for comment in comments %}
                
                <div class="p-2 comments
                {% if not comment.approved and comment.author == user %}
                faded{% elif not comment.approved %} d-none{% endif %}">
                <h4 class="card-title">{{ comment.author }}</h4>
                <div id="comment{{ comment.id }} card-text">
                    {{ comment.content | linebreaks }}
                </div>
                <div class="card-footer border-secondary">{{ comment.created_on }}</div>
                
            </div>
            {% if not comment.approved and comment.author == user %}
            <div class="alert alert-danger bg-transparent border-danger" role="alert">
                <i class="fa-solid fa-triangle-exclamation"></i>
                This comment is awaiting approval.
            </div>
            {% endif %}
                {% endfor %}




            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card border-secondary mb-3 p-3">
            <div class="card-body">
                {% if user.is_authenticated %}
                <div class="card-header border-secondary">
                    <h3 class="card-title">Leave a comment <i class="far fa-comments"></i></h3>
                    <p>{{ user.username }}</p>
                </div>
                <form id="commentForm" method="post" style="margin-top: 1.3em;">
                    {{ comment_form | crispy }}
                    {% csrf_token %}
                    <button id="submitButton" type="submit" class="btn btn-secondary">Submit</button>
                </form>
                {% else %}
                <div class="alert alert-danger bg-transparent border-danger" role="alert">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    Log in to leave a comment!
                </div>
                {% endif %}
            </div>
        </div>
    </div>

</div>
</div>

{% endblock content %}